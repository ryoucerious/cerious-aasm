<!-- Login page - full screen without sidebar -->
<div *ngIf="isLoginPage" class="login-page-container">
  <router-outlet></router-outlet>
</div>

<!-- Main app layout - with sidebar -->
<ng-container *ngIf="!isLoginPage && (isElectron || (!connecting && !connectionLost)); else lostOrConnecting">
  <div class="app-container">
    <!-- Mobile Header -->
    <div *ngIf="isMobile" class="mobile-header">
      <button class="mobile-menu-btn" (click)="toggleMobileMenu()" [attr.aria-label]="isMobileMenuOpen ? 'Close menu' : 'Open menu'">
        <span class="material-icons">{{ isMobileMenuOpen ? 'close' : 'menu' }}</span>
      </button>
      <div class="mobile-header-title">Cerious AASM</div>
    </div>

    <!-- Mobile Overlay -->
    <div *ngIf="isMobile && isMobileMenuOpen" class="mobile-overlay" (click)="closeMobileMenu()"></div>

    <!-- Sidebar Container -->
    <div class="sidebar-container" [class.mobile-open]="isMobile && isMobileMenuOpen">
      <app-sidebar (selectServer)="onServerSelected($event)" (closeMobileMenu)="closeMobileMenu()"></app-sidebar>
    </div>

    <!-- Main Content -->
    <div class="main-content" [class.mobile-menu-open]="isMobile && isMobileMenuOpen">
      <router-outlet></router-outlet>

      <!-- Exit Confirmation Modal -->
      <app-modal [show]="showExitModal" [title]="'Servers Running'" (close)="onExitModalClose('cancel')">
        <div>
          <p>There are running servers. What would you like to do?</p>
          <ul *ngIf="runningServers && runningServers.length > 0">
            <li *ngFor="let server of runningServers">{{ server.name }}</li>
          </ul>
          <div class="action-group-modal">
            <button class="btn" (click)="onExitModalClose('cancel')">Cancel</button>
            <button class="btn" (click)="onExitModalClose('exit')">Exit Anyway</button>
            <button class="btn" (click)="onExitModalClose('shutdown')">Shut Down Servers &amp; Exit</button>
          </div>
        </div>
      </app-modal>
    </div>
  </div>
</ng-container>
<ng-template #lostOrConnecting>
  <div *ngIf="connecting" class="connection-lost-container">
    <div class="connection-lost-content">
      <div class="icon-glitch"><span>üõ∞Ô∏è</span></div>
      <h1>Connecting...</h1>
      <p>Attempting to connect to the web server.</p>
    </div>
  </div>
  <app-connection-lost *ngIf="!connecting && connectionLost"></app-connection-lost>
</ng-template>